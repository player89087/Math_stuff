import random 
import math
import time 
prime = []

nums = []
start = time.time()
for i in range(0,10000000): # insert estimated range of p and q 
    nums.append(True)
nums[0] = False
nums[1] = False
for x in range(0,len(nums)):
    if nums[x] == True:
        prime.append(x)
        for y in range(x,len(nums),x):
            nums[y] = False

n = 2072936688105621022209974143379532247534551100425003418431799385294992154132690896689609676134403867252405561933865553419533516073910456139283021676780096338504532992663330828143618489489238898124836381529020766790204884550063449528141691270610017230792286643209480576931397979694584251771186721834304596365423263528298305886565647138808547471064067511596653037573953915820408578650642023773331754311715363830461281674100200418475601277364491327669612687189684617523163962837686322261591627282445097980226950311145395544340103311993116893146270599537956981134720619613448929110832362239975677388602197787934133171303063439960892227961840719781739441778531459522352631184199410608080874859508155478855560629669747352000600043673046127834013897882375772392951553985013832527660381033506223471744375598700745886456616237560562279806035207386875173645523627672885445965836574984905721646411082392050593464244289369811189914108221179061288982878559835047583233172987412587261

n_found = False 
#i = 0 
x = 1

for i in range(0,len(prime)):
    if n % prime[i] == 0: 
        p = prime[i]
        q = n // p 
        break
    if prime[i] > math.isqrt(n)+1: 
        print("n could be prime")
        break 


phi = (p-1) * (q-1)

e = 2
found = False
while found == False:
    if math.gcd(e,phi) == 1:
        found = True
    elif math.gcd(e,phi) != 1:
        e += 1

d = pow(e,-1,phi) # modulares inverses

print(f"d: {d}") 

secret_msg = [1804229351, 19254145824, 10510100501, 8587340257, 21003416576, 33554432, 13382255776, 16850581551, 9039207968, 33554432, 25937424601, 16850581551, 21924480357, 33554432, 11040808032, 16850581551, 21924480357, 16105100000, 10000000000, 33554432, 21003416576, 12166529024, 10510100501, 33554432, 20113571875, 16850581551, 14693280768, 21924480357, 21003416576, 12762815625, 16850581551, 16105100000, 33554432, 6240321451, 10510100501, 16105100000, 9509900499, 19254145824, 25937424601, 17623416832, 21003416576, 282475249, 254803968, 16105100000, 7737809375, 282475249, 20113571875, 7737809375, 14025517307, 345025251, 25937424601, 205962976, 12166529024, 21003416576, 15386239549, 14693280768, 6956883693, 33554432]

clear_message = []
for i in range(0,len(secret_msg)):
    clear_message.append(pow(secret_msg[i],d,n))
    print(chr(clear_message[i]),end="")

end = time.time()

dur = end -start 

print(dur)
